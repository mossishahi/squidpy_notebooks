
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plotting/compute_extract.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plotting_compute_extract.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plotting_compute_extract.py:


Plot features in adata.obsm
---------------------------

This example shows how to use :func:`squidpy.pl.extract` to plot features in :attr:`anndata.AnnData.obsm`.

.. seealso::

    See :ref:`sphx_glr_auto_examples_image_compute_summary_features.py` for computing an example of such features.

.. GENERATED FROM PYTHON SOURCE LINES 12-17

.. code-block:: default

    import squidpy as sq

    adata = sq.datasets.slideseqv2()
    adata





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

      0%|          | 0.00/251M [00:00<?, ?B/s]      0%|          | 24.0k/251M [00:00<23:59, 183kB/s]      0%|          | 56.0k/251M [00:00<20:13, 217kB/s]      0%|          | 120k/251M [00:00<12:59, 338kB/s]       0%|          | 256k/251M [00:00<07:01, 625kB/s]      0%|          | 544k/251M [00:00<03:41, 1.19MB/s]      0%|          | 1.10M/251M [00:00<01:54, 2.29MB/s]      1%|          | 2.24M/251M [00:00<00:59, 4.42MB/s]      2%|1         | 4.51M/251M [00:01<00:30, 8.57MB/s]      3%|2         | 7.27M/251M [00:01<00:20, 12.6MB/s]      4%|4         | 10.1M/251M [00:01<00:16, 15.3MB/s]      5%|5         | 12.9M/251M [00:01<00:14, 17.2MB/s]      6%|6         | 15.7M/251M [00:01<00:13, 18.5MB/s]      7%|7         | 18.5M/251M [00:01<00:12, 19.4MB/s]      8%|8         | 21.3M/251M [00:01<00:11, 20.1MB/s]     10%|9         | 24.2M/251M [00:02<00:11, 20.8MB/s]     11%|#         | 27.1M/251M [00:02<00:11, 21.3MB/s]     12%|#1        | 30.0M/251M [00:02<00:10, 21.6MB/s]     13%|#3        | 32.9M/251M [00:02<00:10, 21.8MB/s]     14%|#4        | 35.9M/251M [00:02<00:10, 22.0MB/s]     15%|#5        | 38.8M/251M [00:02<00:10, 22.1MB/s]     17%|#6        | 41.7M/251M [00:02<00:09, 22.1MB/s]     18%|#7        | 44.6M/251M [00:02<00:09, 22.2MB/s]     19%|#8        | 47.4M/251M [00:03<00:09, 22.1MB/s]     20%|#9        | 50.1M/251M [00:03<00:09, 21.7MB/s]     21%|##1       | 52.9M/251M [00:03<00:09, 21.7MB/s]     22%|##2       | 55.8M/251M [00:03<00:09, 21.7MB/s]     23%|##3       | 58.7M/251M [00:03<00:09, 22.0MB/s]     25%|##4       | 61.7M/251M [00:03<00:08, 22.1MB/s]     26%|##5       | 64.6M/251M [00:03<00:08, 24.1MB/s]     27%|##6       | 66.9M/251M [00:04<00:08, 23.9MB/s]     27%|##7       | 68.8M/251M [00:04<00:08, 22.8MB/s]     28%|##8       | 70.5M/251M [00:04<00:08, 21.2MB/s]     29%|##9       | 73.3M/251M [00:04<00:07, 23.4MB/s]     30%|##9       | 75.2M/251M [00:04<00:08, 22.3MB/s]     31%|###       | 77.3M/251M [00:04<00:08, 22.2MB/s]     31%|###1      | 78.9M/251M [00:04<00:08, 20.4MB/s]     33%|###2      | 81.9M/251M [00:04<00:08, 21.1MB/s]     34%|###3      | 84.7M/251M [00:04<00:08, 21.4MB/s]     35%|###4      | 87.6M/251M [00:05<00:07, 21.6MB/s]     36%|###5      | 90.4M/251M [00:05<00:07, 21.5MB/s]     37%|###6      | 93.0M/251M [00:05<00:07, 21.0MB/s]     38%|###8      | 95.8M/251M [00:05<00:07, 21.3MB/s]     39%|###9      | 98.7M/251M [00:05<00:07, 21.6MB/s]     40%|####      | 102M/251M [00:05<00:07, 21.9MB/s]      42%|####1     | 105M/251M [00:05<00:06, 22.1MB/s]     43%|####2     | 107M/251M [00:05<00:06, 22.1MB/s]     44%|####3     | 110M/251M [00:06<00:06, 22.1MB/s]     45%|####5     | 113M/251M [00:06<00:06, 22.1MB/s]     46%|####6     | 116M/251M [00:06<00:06, 22.0MB/s]     47%|####7     | 119M/251M [00:06<00:05, 23.5MB/s]     48%|####8     | 121M/251M [00:06<00:05, 23.3MB/s]     49%|####9     | 123M/251M [00:06<00:06, 22.0MB/s]     50%|####9     | 126M/251M [00:06<00:06, 21.5MB/s]     51%|#####     | 128M/251M [00:06<00:06, 21.2MB/s]     52%|#####1    | 130M/251M [00:07<00:05, 21.4MB/s]     53%|#####2    | 133M/251M [00:07<00:05, 22.6MB/s]     54%|#####3    | 136M/251M [00:07<00:05, 23.9MB/s]     55%|#####4    | 137M/251M [00:07<00:05, 21.3MB/s]     55%|#####5    | 139M/251M [00:07<00:05, 21.8MB/s]     56%|#####6    | 142M/251M [00:07<00:05, 21.1MB/s]     57%|#####7    | 144M/251M [00:07<00:04, 22.8MB/s]     58%|#####8    | 147M/251M [00:07<00:04, 23.0MB/s]     59%|#####9    | 148M/251M [00:07<00:05, 21.0MB/s]     60%|######    | 151M/251M [00:08<00:04, 22.1MB/s]     61%|######    | 153M/251M [00:08<00:04, 22.7MB/s]     62%|######1   | 155M/251M [00:08<00:04, 22.6MB/s]     63%|######2   | 157M/251M [00:08<00:04, 21.3MB/s]     63%|######3   | 160M/251M [00:08<00:04, 22.3MB/s]     64%|######4   | 162M/251M [00:08<00:04, 22.6MB/s]     65%|######5   | 164M/251M [00:08<00:04, 22.0MB/s]     66%|######5   | 166M/251M [00:08<00:04, 21.1MB/s]     67%|######6   | 168M/251M [00:08<00:04, 21.4MB/s]     68%|######7   | 171M/251M [00:08<00:03, 22.3MB/s]     69%|######8   | 173M/251M [00:09<00:03, 23.4MB/s]     70%|######9   | 175M/251M [00:09<00:03, 21.6MB/s]     70%|#######   | 177M/251M [00:09<00:03, 20.3MB/s]     72%|#######1  | 180M/251M [00:09<00:03, 21.6MB/s]     73%|#######2  | 182M/251M [00:09<00:03, 23.0MB/s]     73%|#######3  | 184M/251M [00:09<00:03, 22.4MB/s]     74%|#######4  | 187M/251M [00:09<00:03, 21.3MB/s]     75%|#######4  | 188M/251M [00:09<00:03, 20.1MB/s]     76%|#######6  | 191M/251M [00:10<00:03, 20.9MB/s]     77%|#######7  | 194M/251M [00:10<00:02, 21.4MB/s]     78%|#######8  | 197M/251M [00:10<00:02, 21.4MB/s]     79%|#######9  | 200M/251M [00:10<00:02, 21.7MB/s]     81%|########  | 203M/251M [00:10<00:02, 21.8MB/s]     82%|########1 | 205M/251M [00:10<00:02, 21.4MB/s]     83%|########2 | 208M/251M [00:10<00:02, 21.7MB/s]     84%|########4 | 211M/251M [00:10<00:01, 22.0MB/s]     85%|########5 | 214M/251M [00:11<00:01, 22.2MB/s]     86%|########6 | 217M/251M [00:11<00:01, 22.5MB/s]     87%|########7 | 220M/251M [00:11<00:01, 21.7MB/s]     89%|########8 | 223M/251M [00:11<00:01, 21.8MB/s]     90%|########9 | 225M/251M [00:11<00:01, 21.8MB/s]     91%|######### | 228M/251M [00:11<00:01, 21.9MB/s]     92%|#########2| 231M/251M [00:11<00:00, 22.0MB/s]     93%|#########3| 234M/251M [00:12<00:00, 21.7MB/s]     94%|#########4| 237M/251M [00:12<00:00, 21.4MB/s]     95%|#########5| 240M/251M [00:12<00:00, 21.8MB/s]     96%|#########6| 242M/251M [00:12<00:00, 21.5MB/s]     97%|#########7| 245M/251M [00:12<00:00, 20.5MB/s]     99%|#########8| 248M/251M [00:12<00:00, 21.2MB/s]    100%|#########9| 250M/251M [00:12<00:00, 21.1MB/s]    100%|##########| 251M/251M [00:12<00:00, 20.5MB/s]

    AnnData object with n_obs × n_vars = 41786 × 4000
        obs: 'barcode', 'x', 'y', 'n_genes_by_counts', 'log1p_n_genes_by_counts', 'total_counts', 'log1p_total_counts', 'pct_counts_in_top_50_genes', 'pct_counts_in_top_100_genes', 'pct_counts_in_top_200_genes', 'pct_counts_in_top_500_genes', 'total_counts_MT', 'log1p_total_counts_MT', 'pct_counts_MT', 'n_counts', 'leiden', 'cluster'
        var: 'MT', 'n_cells_by_counts', 'mean_counts', 'log1p_mean_counts', 'pct_dropout_by_counts', 'total_counts', 'log1p_total_counts', 'n_cells', 'highly_variable', 'highly_variable_rank', 'means', 'variances', 'variances_norm'
        uns: 'cluster_colors', 'hvg', 'leiden', 'leiden_colors', 'neighbors', 'pca', 'spatial_neighbors', 'umap'
        obsm: 'X_pca', 'X_umap', 'deconvolution_results', 'spatial'
        varm: 'PCs'
        obsp: 'connectivities', 'distances', 'spatial_connectivities', 'spatial_distances'



.. GENERATED FROM PYTHON SOURCE LINES 18-20

In this dataset, we have saved deconvolution results in :attr:`anndata.AnnData.obsm` and we
would like to plot them with :func:`squidpy.pl.spatial_scatter`.

.. GENERATED FROM PYTHON SOURCE LINES 20-22

.. code-block:: default

    adata.obsm["deconvolution_results"].head(10)






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Interneurons</th>
          <th>Subiculum_Entorhinal_cl2</th>
          <th>Subiculum_Entorhinal_cl3</th>
          <th>DentatePyramids</th>
          <th>CA1_CA2_CA3_Subiculum</th>
          <th>Mural</th>
          <th>Astrocytes</th>
          <th>Oligodendrocytes</th>
          <th>Polydendrocytes</th>
          <th>Microglia</th>
          <th>Ependymal</th>
          <th>Endothelial_Tip</th>
          <th>Neurogenesis</th>
          <th>Endothelial_Stalk</th>
          <th>barcode</th>
          <th>max_cell_type</th>
          <th>maxval</th>
          <th>thresh_ct</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>AACGTCATAATCGT</th>
          <td>0.113249</td>
          <td>0.203010</td>
          <td>0.086060</td>
          <td>0.247319</td>
          <td>0.153769</td>
          <td>0.002455</td>
          <td>0.072134</td>
          <td>0.022327</td>
          <td>0.008712</td>
          <td>0.065562</td>
          <td>0.003853</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.021550</td>
          <td>AACGTCATAATCGT</td>
          <td>4</td>
          <td>0.247319</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>TACTTTAGCGCAGT</th>
          <td>0.055718</td>
          <td>0.077973</td>
          <td>0.048517</td>
          <td>0.187755</td>
          <td>0.195889</td>
          <td>0.040198</td>
          <td>0.126317</td>
          <td>0.071605</td>
          <td>0.052353</td>
          <td>0.013668</td>
          <td>0.016075</td>
          <td>0.044060</td>
          <td>0.012159</td>
          <td>0.057714</td>
          <td>TACTTTAGCGCAGT</td>
          <td>5</td>
          <td>0.195889</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>CATGCCTGGGTTCG</th>
          <td>0.108751</td>
          <td>0.228845</td>
          <td>0.109581</td>
          <td>0.246070</td>
          <td>0.115723</td>
          <td>0.006306</td>
          <td>0.071186</td>
          <td>0.015768</td>
          <td>0.000000</td>
          <td>0.059735</td>
          <td>0.000000</td>
          <td>0.013702</td>
          <td>0.000000</td>
          <td>0.024332</td>
          <td>CATGCCTGGGTTCG</td>
          <td>4</td>
          <td>0.246070</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>TCGATATGGCACAA</th>
          <td>0.108163</td>
          <td>0.029694</td>
          <td>0.112905</td>
          <td>0.172960</td>
          <td>0.122573</td>
          <td>0.014295</td>
          <td>0.065901</td>
          <td>0.031834</td>
          <td>0.096153</td>
          <td>0.034155</td>
          <td>0.094124</td>
          <td>0.065322</td>
          <td>0.011114</td>
          <td>0.040808</td>
          <td>TCGATATGGCACAA</td>
          <td>4</td>
          <td>0.172960</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>TTATCTGACGAAGC</th>
          <td>0.065790</td>
          <td>0.236463</td>
          <td>0.012458</td>
          <td>0.233441</td>
          <td>0.145091</td>
          <td>0.014810</td>
          <td>0.097935</td>
          <td>0.052590</td>
          <td>0.023642</td>
          <td>0.008578</td>
          <td>0.014275</td>
          <td>0.058715</td>
          <td>0.000000</td>
          <td>0.036213</td>
          <td>TTATCTGACGAAGC</td>
          <td>2</td>
          <td>0.236463</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>GATGCGACTCCTCG</th>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.222606</td>
          <td>0.705572</td>
          <td>0.042319</td>
          <td>0.009459</td>
          <td>0.000000</td>
          <td>0.002753</td>
          <td>0.009457</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.004932</td>
          <td>0.002902</td>
          <td>GATGCGACTCCTCG</td>
          <td>5</td>
          <td>0.705572</td>
          <td>0.705572</td>
        </tr>
        <tr>
          <th>ACGGATGTTCCGAT</th>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.037305</td>
          <td>0.078873</td>
          <td>0.014507</td>
          <td>0.032262</td>
          <td>0.500225</td>
          <td>0.099139</td>
          <td>0.147571</td>
          <td>0.013209</td>
          <td>0.023574</td>
          <td>0.010208</td>
          <td>0.043127</td>
          <td>ACGGATGTTCCGAT</td>
          <td>8</td>
          <td>0.500225</td>
          <td>0.500225</td>
        </tr>
        <tr>
          <th>TCTCATGGGTGGGA</th>
          <td>0.011898</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.114613</td>
          <td>0.089905</td>
          <td>0.010118</td>
          <td>0.411598</td>
          <td>0.188769</td>
          <td>0.034367</td>
          <td>0.059139</td>
          <td>0.000000</td>
          <td>0.029453</td>
          <td>0.017615</td>
          <td>0.032526</td>
          <td>TCTCATGGGTGGGA</td>
          <td>7</td>
          <td>0.411598</td>
          <td>0.411598</td>
        </tr>
        <tr>
          <th>ACCGGAACTTCTTC</th>
          <td>0.016862</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.017110</td>
          <td>0.070573</td>
          <td>0.017013</td>
          <td>0.006445</td>
          <td>0.091637</td>
          <td>0.034633</td>
          <td>0.022682</td>
          <td>0.659986</td>
          <td>0.029675</td>
          <td>0.009862</td>
          <td>0.023523</td>
          <td>ACCGGAACTTCTTC</td>
          <td>11</td>
          <td>0.659986</td>
          <td>0.659986</td>
        </tr>
        <tr>
          <th>ACAGGGTTTATCGA</th>
          <td>0.012235</td>
          <td>0.000000</td>
          <td>0.010678</td>
          <td>0.138919</td>
          <td>0.723275</td>
          <td>0.026109</td>
          <td>0.029469</td>
          <td>0.003275</td>
          <td>0.003829</td>
          <td>0.011391</td>
          <td>0.011063</td>
          <td>0.000000</td>
          <td>0.014785</td>
          <td>0.014970</td>
          <td>ACAGGGTTTATCGA</td>
          <td>5</td>
          <td>0.723275</td>
          <td>0.723275</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 23-25

Squidpy provides an easy wrapper that creates a temporary copy of the
feature matrix and pass it to :attr:`anndata.AnnData.obs`.

.. GENERATED FROM PYTHON SOURCE LINES 25-31

.. code-block:: default

    sq.pl.spatial_scatter(
        sq.pl.extract(adata, "deconvolution_results"),
        shape=None,
        color=["Astrocytes", "Mural", "CA1_CA2_CA3_Subiculum"],
        size=4,
    )



.. image-sg:: /auto_examples/plotting/images/sphx_glr_compute_extract_001.png
   :alt: Astrocytes, Mural, CA1_CA2_CA3_Subiculum
   :srcset: /auto_examples/plotting/images/sphx_glr_compute_extract_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  33.722 seconds)

**Estimated memory usage:**  259 MB


.. _sphx_glr_download_auto_examples_plotting_compute_extract.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: compute_extract.py <compute_extract.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: compute_extract.ipynb <compute_extract.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
