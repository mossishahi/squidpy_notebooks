
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/graph/compute_ligrec.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_graph_compute_ligrec.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_graph_compute_ligrec.py:


Receptor-ligand analysis
------------------------

This example shows how to run the receptor-ligand analysis.

It uses an efficient re-implementation of the :cite:`cellphonedb` algorithm which can handle large number of interacting
pairs (100k+) and cluster combinations (100+).

.. seealso::

    See :ref:`sphx_glr_auto_examples_graph_compute_nhood_enrichment.py` for
    finding cluster neighborhood with :func:`squidpy.gr.nhood_enrichment`.

.. GENERATED FROM PYTHON SOURCE LINES 16-21

.. code-block:: default

    import squidpy as sq

    adata = sq.datasets.seqfish()
    adata





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

      0%|          | 0.00/30.7M [00:00<?, ?B/s]      0%|          | 16.0k/30.7M [00:00<04:22, 122kB/s]      0%|          | 56.0k/30.7M [00:00<02:20, 229kB/s]      0%|          | 120k/30.7M [00:00<01:32, 345kB/s]       1%|          | 256k/30.7M [00:00<00:52, 613kB/s]      2%|1         | 528k/30.7M [00:00<00:27, 1.13MB/s]      3%|3         | 1.06M/30.7M [00:00<00:14, 2.18MB/s]      7%|7         | 2.16M/30.7M [00:00<00:07, 4.23MB/s]     14%|#4        | 4.34M/30.7M [00:01<00:03, 8.26MB/s]     24%|##3       | 7.23M/30.7M [00:01<00:01, 12.6MB/s]     32%|###2      | 9.89M/30.7M [00:01<00:01, 15.0MB/s]     41%|####1     | 12.7M/30.7M [00:01<00:01, 17.1MB/s]     50%|#####     | 15.3M/30.7M [00:01<00:00, 18.0MB/s]     59%|#####9    | 18.2M/30.7M [00:01<00:00, 19.3MB/s]     68%|######7   | 20.9M/30.7M [00:01<00:00, 19.6MB/s]     76%|#######6  | 23.3M/30.7M [00:02<00:00, 19.4MB/s]     86%|########5 | 26.3M/30.7M [00:02<00:00, 20.4MB/s]     95%|#########5| 29.2M/30.7M [00:02<00:00, 21.0MB/s]    100%|##########| 30.7M/30.7M [00:02<00:00, 13.8MB/s]

    AnnData object with n_obs × n_vars = 19416 × 351
        obs: 'Area', 'celltype_mapped_refined'
        uns: 'celltype_mapped_refined_colors'
        obsm: 'X_umap', 'spatial'



.. GENERATED FROM PYTHON SOURCE LINES 22-37

To get started, we just need an :class:`anndata.AnnData` object with some clustering information. Below are some
useful parameters of :func:`squidpy.gr.ligrec`:

  - ``n_perms`` - number of permutations for the permutation test.
  - ``interactions`` - list of interaction, by default we fetch all available interactions from :cite:`omnipath`.
  - ``{interactions,transmitter,receiver}_params`` - parameters used if downloading the ``interactions``,
    see :func:`omnipah.interactions.import_intercell_network` for more information.
  - ``threshold`` - percentage of cells required to be expressed in a given cluster.
  - ``corr_method`` - false discovery rate (FDR) correction method to use.

Since we're interested in receptors and ligands in this example, we specify these categories in ``receiver_params``
and ``transmitter_params``, respectively.
If desired, we can also restrict the resources to just a select few. For example, in order to only use
:cite:`cellphonedb`, set ``interactions_params={'resources': 'CellPhoneDB'}``.


.. GENERATED FROM PYTHON SOURCE LINES 37-47

.. code-block:: default

    res = sq.gr.ligrec(
        adata,
        n_perms=1000,
        cluster_key="celltype_mapped_refined",
        copy=True,
        use_raw=False,
        transmitter_params={"categories": "ligand"},
        receiver_params={"categories": "receptor"},
    )





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    0.00B [00:00, ?B/s]    145kB [00:00, 1.03MB/s]    325kB [00:00, 1.17MB/s]    786kB [00:00, 2.12MB/s]    1.57MB [00:00, 3.55MB/s]    3.17MB [00:00, 6.45MB/s]    8.68MB [00:00, 17.8MB/s]    14.2MB [00:00, 16.5MB/s]
    0.00B [00:00, ?B/s]    309kB [00:00, 2.22MB/s]    704kB [00:00, 2.57MB/s]    1.64MB [00:00, 5.30MB/s]
    0.00B [00:00, ?B/s]    286kB [00:00, 2.04MB/s]    633kB [00:00, 2.28MB/s]    1.54MB [00:00, 4.28MB/s]    3.05MB [00:00, 6.91MB/s]    3.94MB [00:00, 7.09MB/s]
      0%|          | 0/1000 [00:00<?, ?permutation/s]      0%|          | 1/1000 [00:07<2:06:58,  7.63s/permutation]      4%|3         | 37/1000 [00:07<02:22,  6.75permutation/s]       8%|8         | 80/1000 [00:07<00:52, 17.58permutation/s]     12%|#2        | 120/1000 [00:07<00:28, 31.04permutation/s]     17%|#7        | 173/1000 [00:08<00:15, 54.96permutation/s]     22%|##1       | 218/1000 [00:08<00:09, 80.16permutation/s]     26%|##6       | 261/1000 [00:08<00:06, 107.12permutation/s]     32%|###1      | 315/1000 [00:08<00:04, 152.41permutation/s]     39%|###8      | 386/1000 [00:08<00:02, 224.68permutation/s]     44%|####3     | 439/1000 [00:08<00:02, 267.32permutation/s]     49%|####9     | 490/1000 [00:08<00:01, 278.30permutation/s]     54%|#####4    | 543/1000 [00:08<00:01, 324.46permutation/s]     61%|######    | 607/1000 [00:08<00:01, 389.29permutation/s]     66%|######5   | 659/1000 [00:09<00:00, 397.67permutation/s]     71%|#######1  | 714/1000 [00:09<00:00, 432.54permutation/s]     76%|#######6  | 765/1000 [00:09<00:00, 430.34permutation/s]     81%|########1 | 814/1000 [00:09<00:00, 411.96permutation/s]     86%|########5 | 859/1000 [00:09<00:00, 416.00permutation/s]     90%|######### | 905/1000 [00:09<00:00, 426.92permutation/s]     95%|#########5| 950/1000 [00:09<00:00, 401.54permutation/s]    100%|##########| 1000/1000 [00:09<00:00, 102.20permutation/s]




.. GENERATED FROM PYTHON SOURCE LINES 48-50

First, we inspect the calculated means. The resulting object is a :class:`pandas.DataFrame`, with rows corresponding
to interacting pairs and columns to cluster combinations.

.. GENERATED FROM PYTHON SOURCE LINES 50-52

.. code-block:: default

    res["means"].head()






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th></th>
          <th>cluster_1</th>
          <th colspan="22" halign="left">Allantois</th>
          <th colspan="18" halign="left">Anterior somitic tissues</th>
          <th>...</th>
          <th colspan="18" halign="left">Splanchnic mesoderm</th>
          <th colspan="22" halign="left">Surface ectoderm</th>
        </tr>
        <tr>
          <th></th>
          <th>cluster_2</th>
          <th>Allantois</th>
          <th>Anterior somitic tissues</th>
          <th>Cardiomyocytes</th>
          <th>Cranial mesoderm</th>
          <th>Definitive endoderm</th>
          <th>Dermomyotome</th>
          <th>Endothelium</th>
          <th>Erythroid</th>
          <th>Forebrain/Midbrain/Hindbrain</th>
          <th>Gut tube</th>
          <th>Haematoendothelial progenitors</th>
          <th>Intermediate mesoderm</th>
          <th>Lateral plate mesoderm</th>
          <th>Low quality</th>
          <th>Mixed mesenchymal mesoderm</th>
          <th>NMP</th>
          <th>Neural crest</th>
          <th>Presomitic mesoderm</th>
          <th>Sclerotome</th>
          <th>Spinal cord</th>
          <th>Splanchnic mesoderm</th>
          <th>Surface ectoderm</th>
          <th>Allantois</th>
          <th>Anterior somitic tissues</th>
          <th>Cardiomyocytes</th>
          <th>Cranial mesoderm</th>
          <th>Definitive endoderm</th>
          <th>Dermomyotome</th>
          <th>Endothelium</th>
          <th>Erythroid</th>
          <th>Forebrain/Midbrain/Hindbrain</th>
          <th>Gut tube</th>
          <th>Haematoendothelial progenitors</th>
          <th>Intermediate mesoderm</th>
          <th>Lateral plate mesoderm</th>
          <th>Low quality</th>
          <th>Mixed mesenchymal mesoderm</th>
          <th>NMP</th>
          <th>Neural crest</th>
          <th>Presomitic mesoderm</th>
          <th>...</th>
          <th>Definitive endoderm</th>
          <th>Dermomyotome</th>
          <th>Endothelium</th>
          <th>Erythroid</th>
          <th>Forebrain/Midbrain/Hindbrain</th>
          <th>Gut tube</th>
          <th>Haematoendothelial progenitors</th>
          <th>Intermediate mesoderm</th>
          <th>Lateral plate mesoderm</th>
          <th>Low quality</th>
          <th>Mixed mesenchymal mesoderm</th>
          <th>NMP</th>
          <th>Neural crest</th>
          <th>Presomitic mesoderm</th>
          <th>Sclerotome</th>
          <th>Spinal cord</th>
          <th>Splanchnic mesoderm</th>
          <th>Surface ectoderm</th>
          <th>Allantois</th>
          <th>Anterior somitic tissues</th>
          <th>Cardiomyocytes</th>
          <th>Cranial mesoderm</th>
          <th>Definitive endoderm</th>
          <th>Dermomyotome</th>
          <th>Endothelium</th>
          <th>Erythroid</th>
          <th>Forebrain/Midbrain/Hindbrain</th>
          <th>Gut tube</th>
          <th>Haematoendothelial progenitors</th>
          <th>Intermediate mesoderm</th>
          <th>Lateral plate mesoderm</th>
          <th>Low quality</th>
          <th>Mixed mesenchymal mesoderm</th>
          <th>NMP</th>
          <th>Neural crest</th>
          <th>Presomitic mesoderm</th>
          <th>Sclerotome</th>
          <th>Spinal cord</th>
          <th>Splanchnic mesoderm</th>
          <th>Surface ectoderm</th>
        </tr>
        <tr>
          <th>source</th>
          <th>target</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>KDR</th>
          <th>PECAM1</th>
          <td>0.142857</td>
          <td>0.294237</td>
          <td>0.150901</td>
          <td>0.233090</td>
          <td>0.183007</td>
          <td>0.187666</td>
          <td>1.475811</td>
          <td>0.214416</td>
          <td>0.160415</td>
          <td>0.190973</td>
          <td>0.798701</td>
          <td>0.220050</td>
          <td>0.184174</td>
          <td>0.214811</td>
          <td>0.189776</td>
          <td>0.166984</td>
          <td>0.231345</td>
          <td>0.187036</td>
          <td>0.199800</td>
          <td>0.155408</td>
          <td>0.148124</td>
          <td>0.189284</td>
          <td>0.464692</td>
          <td>0.616071</td>
          <td>0.472736</td>
          <td>0.554924</td>
          <td>0.504842</td>
          <td>0.509500</td>
          <td>1.797646</td>
          <td>0.536250</td>
          <td>0.482249</td>
          <td>0.512807</td>
          <td>1.120536</td>
          <td>0.541884</td>
          <td>0.506009</td>
          <td>0.536645</td>
          <td>0.511610</td>
          <td>0.488819</td>
          <td>0.553180</td>
          <td>0.508870</td>
          <td>...</td>
          <td>0.216342</td>
          <td>0.221001</td>
          <td>1.509146</td>
          <td>0.247750</td>
          <td>0.193749</td>
          <td>0.224308</td>
          <td>0.832036</td>
          <td>0.253384</td>
          <td>0.217509</td>
          <td>0.248146</td>
          <td>0.223111</td>
          <td>0.200319</td>
          <td>0.264680</td>
          <td>0.220371</td>
          <td>0.233135</td>
          <td>0.188743</td>
          <td>0.181459</td>
          <td>0.222619</td>
          <td>0.230102</td>
          <td>0.381482</td>
          <td>0.238146</td>
          <td>0.320335</td>
          <td>0.270252</td>
          <td>0.274911</td>
          <td>1.563056</td>
          <td>0.301660</td>
          <td>0.247659</td>
          <td>0.278218</td>
          <td>0.885946</td>
          <td>0.307294</td>
          <td>0.271419</td>
          <td>0.302056</td>
          <td>0.277021</td>
          <td>0.254229</td>
          <td>0.318590</td>
          <td>0.274281</td>
          <td>0.287045</td>
          <td>0.242653</td>
          <td>0.235369</td>
          <td>0.276529</td>
        </tr>
        <tr>
          <th>IGF1</th>
          <th>KDR</th>
          <td>0.162338</td>
          <td>0.484172</td>
          <td>0.250242</td>
          <td>0.232278</td>
          <td>0.164777</td>
          <td>0.246182</td>
          <td>2.253158</td>
          <td>0.192922</td>
          <td>0.141502</td>
          <td>0.169111</td>
          <td>1.296132</td>
          <td>0.281774</td>
          <td>0.253304</td>
          <td>0.218348</td>
          <td>0.214706</td>
          <td>0.155904</td>
          <td>0.231979</td>
          <td>0.294079</td>
          <td>0.212537</td>
          <td>0.177159</td>
          <td>0.195673</td>
          <td>0.249583</td>
          <td>0.276380</td>
          <td>0.598214</td>
          <td>0.364285</td>
          <td>0.346320</td>
          <td>0.278819</td>
          <td>0.360224</td>
          <td>2.367200</td>
          <td>0.306964</td>
          <td>0.255544</td>
          <td>0.283153</td>
          <td>1.410175</td>
          <td>0.395817</td>
          <td>0.367346</td>
          <td>0.332390</td>
          <td>0.328748</td>
          <td>0.269946</td>
          <td>0.346021</td>
          <td>0.408121</td>
          <td>...</td>
          <td>0.193181</td>
          <td>0.274587</td>
          <td>2.281563</td>
          <td>0.221327</td>
          <td>0.169907</td>
          <td>0.197515</td>
          <td>1.324537</td>
          <td>0.310179</td>
          <td>0.281709</td>
          <td>0.246752</td>
          <td>0.243111</td>
          <td>0.184309</td>
          <td>0.260384</td>
          <td>0.322484</td>
          <td>0.240942</td>
          <td>0.205564</td>
          <td>0.224077</td>
          <td>0.277987</td>
          <td>0.236725</td>
          <td>0.558560</td>
          <td>0.324630</td>
          <td>0.306666</td>
          <td>0.239164</td>
          <td>0.320570</td>
          <td>2.327546</td>
          <td>0.267310</td>
          <td>0.215890</td>
          <td>0.243498</td>
          <td>1.370520</td>
          <td>0.356162</td>
          <td>0.327692</td>
          <td>0.292735</td>
          <td>0.289093</td>
          <td>0.230291</td>
          <td>0.306367</td>
          <td>0.368467</td>
          <td>0.286925</td>
          <td>0.251546</td>
          <td>0.270060</td>
          <td>0.323970</td>
        </tr>
        <tr>
          <th>PDGFA</th>
          <th>KDR</th>
          <td>0.240260</td>
          <td>0.562094</td>
          <td>0.328164</td>
          <td>0.310200</td>
          <td>0.242699</td>
          <td>0.324104</td>
          <td>2.331080</td>
          <td>0.270844</td>
          <td>0.219424</td>
          <td>0.247033</td>
          <td>1.374055</td>
          <td>0.359696</td>
          <td>0.331226</td>
          <td>0.296270</td>
          <td>0.292628</td>
          <td>0.233826</td>
          <td>0.309901</td>
          <td>0.372001</td>
          <td>0.290460</td>
          <td>0.255081</td>
          <td>0.273595</td>
          <td>0.327505</td>
          <td>0.267451</td>
          <td>0.589286</td>
          <td>0.355356</td>
          <td>0.337392</td>
          <td>0.269890</td>
          <td>0.351296</td>
          <td>2.358272</td>
          <td>0.298036</td>
          <td>0.246616</td>
          <td>0.274224</td>
          <td>1.401246</td>
          <td>0.386888</td>
          <td>0.358418</td>
          <td>0.323461</td>
          <td>0.319819</td>
          <td>0.261017</td>
          <td>0.337093</td>
          <td>0.399193</td>
          <td>...</td>
          <td>0.247224</td>
          <td>0.328629</td>
          <td>2.335605</td>
          <td>0.275369</td>
          <td>0.223949</td>
          <td>0.251558</td>
          <td>1.378579</td>
          <td>0.364221</td>
          <td>0.335751</td>
          <td>0.300795</td>
          <td>0.297153</td>
          <td>0.238351</td>
          <td>0.314426</td>
          <td>0.376526</td>
          <td>0.294984</td>
          <td>0.259606</td>
          <td>0.278120</td>
          <td>0.332029</td>
          <td>1.657449</td>
          <td>1.979284</td>
          <td>1.745354</td>
          <td>1.727390</td>
          <td>1.659888</td>
          <td>1.741294</td>
          <td>3.748270</td>
          <td>1.688034</td>
          <td>1.636614</td>
          <td>1.664222</td>
          <td>2.791244</td>
          <td>1.776886</td>
          <td>1.748416</td>
          <td>1.713459</td>
          <td>1.709817</td>
          <td>1.651015</td>
          <td>1.727091</td>
          <td>1.789191</td>
          <td>1.707649</td>
          <td>1.672270</td>
          <td>1.690784</td>
          <td>1.744694</td>
        </tr>
        <tr>
          <th>NRP1</th>
          <th>KDR</th>
          <td>0.532468</td>
          <td>0.854302</td>
          <td>0.620372</td>
          <td>0.602408</td>
          <td>0.534906</td>
          <td>0.616312</td>
          <td>2.623288</td>
          <td>0.563052</td>
          <td>0.511632</td>
          <td>0.539240</td>
          <td>1.666262</td>
          <td>0.651904</td>
          <td>0.623434</td>
          <td>0.588477</td>
          <td>0.584836</td>
          <td>0.526034</td>
          <td>0.602109</td>
          <td>0.664209</td>
          <td>0.582667</td>
          <td>0.547289</td>
          <td>0.565802</td>
          <td>0.619712</td>
          <td>0.651380</td>
          <td>0.973214</td>
          <td>0.739285</td>
          <td>0.721320</td>
          <td>0.653819</td>
          <td>0.735224</td>
          <td>2.742200</td>
          <td>0.681964</td>
          <td>0.630544</td>
          <td>0.658153</td>
          <td>1.785175</td>
          <td>0.770817</td>
          <td>0.742346</td>
          <td>0.707390</td>
          <td>0.703748</td>
          <td>0.644946</td>
          <td>0.721021</td>
          <td>0.783121</td>
          <td>...</td>
          <td>0.753375</td>
          <td>0.834780</td>
          <td>2.841756</td>
          <td>0.781520</td>
          <td>0.730100</td>
          <td>0.757709</td>
          <td>1.884731</td>
          <td>0.870373</td>
          <td>0.841902</td>
          <td>0.806946</td>
          <td>0.803304</td>
          <td>0.744502</td>
          <td>0.820577</td>
          <td>0.882677</td>
          <td>0.801136</td>
          <td>0.765757</td>
          <td>0.784271</td>
          <td>0.838181</td>
          <td>0.467062</td>
          <td>0.788897</td>
          <td>0.554967</td>
          <td>0.537003</td>
          <td>0.469501</td>
          <td>0.550907</td>
          <td>2.557883</td>
          <td>0.497647</td>
          <td>0.446227</td>
          <td>0.473835</td>
          <td>1.600857</td>
          <td>0.586499</td>
          <td>0.558029</td>
          <td>0.523072</td>
          <td>0.519430</td>
          <td>0.460628</td>
          <td>0.536704</td>
          <td>0.598804</td>
          <td>0.517262</td>
          <td>0.481883</td>
          <td>0.500397</td>
          <td>0.554307</td>
        </tr>
        <tr>
          <th>FGF3</th>
          <th>FGFR3</th>
          <td>0.324675</td>
          <td>0.162744</td>
          <td>0.288913</td>
          <td>0.216180</td>
          <td>0.467593</td>
          <td>0.204117</td>
          <td>0.191248</td>
          <td>0.139589</td>
          <td>0.705757</td>
          <td>0.270203</td>
          <td>0.245112</td>
          <td>0.195097</td>
          <td>0.193369</td>
          <td>0.172147</td>
          <td>0.569604</td>
          <td>0.495353</td>
          <td>0.237462</td>
          <td>0.205651</td>
          <td>0.206127</td>
          <td>0.415708</td>
          <td>0.323089</td>
          <td>0.331355</td>
          <td>0.385146</td>
          <td>0.223214</td>
          <td>0.349383</td>
          <td>0.276650</td>
          <td>0.528064</td>
          <td>0.264588</td>
          <td>0.251719</td>
          <td>0.200060</td>
          <td>0.766228</td>
          <td>0.330674</td>
          <td>0.305583</td>
          <td>0.255568</td>
          <td>0.253839</td>
          <td>0.232618</td>
          <td>0.630075</td>
          <td>0.555824</td>
          <td>0.297932</td>
          <td>0.266122</td>
          <td>...</td>
          <td>0.447668</td>
          <td>0.184192</td>
          <td>0.171323</td>
          <td>0.119663</td>
          <td>0.685831</td>
          <td>0.250278</td>
          <td>0.225186</td>
          <td>0.175171</td>
          <td>0.173443</td>
          <td>0.152221</td>
          <td>0.549679</td>
          <td>0.475428</td>
          <td>0.217536</td>
          <td>0.185726</td>
          <td>0.186202</td>
          <td>0.395783</td>
          <td>0.303163</td>
          <td>0.311430</td>
          <td>0.387203</td>
          <td>0.225271</td>
          <td>0.351440</td>
          <td>0.278707</td>
          <td>0.530121</td>
          <td>0.266644</td>
          <td>0.253776</td>
          <td>0.202116</td>
          <td>0.768284</td>
          <td>0.332731</td>
          <td>0.307639</td>
          <td>0.257624</td>
          <td>0.255896</td>
          <td>0.234674</td>
          <td>0.632132</td>
          <td>0.557881</td>
          <td>0.299989</td>
          <td>0.268179</td>
          <td>0.268655</td>
          <td>0.478236</td>
          <td>0.385616</td>
          <td>0.393883</td>
        </tr>
      </tbody>
    </table>
    <p>5 rows × 484 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 53-56

Next, we take a look at the p-values. If ``corr_method != None``, this will contained the corrected p-values.
The p-values marked as `NaN` correspond to interactions, which did not pass the filtering ``threshold`` specified
above.

.. GENERATED FROM PYTHON SOURCE LINES 56-58

.. code-block:: default

    res["pvalues"].head()






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th></th>
          <th>cluster_1</th>
          <th colspan="22" halign="left">Allantois</th>
          <th colspan="18" halign="left">Anterior somitic tissues</th>
          <th>...</th>
          <th colspan="18" halign="left">Splanchnic mesoderm</th>
          <th colspan="22" halign="left">Surface ectoderm</th>
        </tr>
        <tr>
          <th></th>
          <th>cluster_2</th>
          <th>Allantois</th>
          <th>Anterior somitic tissues</th>
          <th>Cardiomyocytes</th>
          <th>Cranial mesoderm</th>
          <th>Definitive endoderm</th>
          <th>Dermomyotome</th>
          <th>Endothelium</th>
          <th>Erythroid</th>
          <th>Forebrain/Midbrain/Hindbrain</th>
          <th>Gut tube</th>
          <th>Haematoendothelial progenitors</th>
          <th>Intermediate mesoderm</th>
          <th>Lateral plate mesoderm</th>
          <th>Low quality</th>
          <th>Mixed mesenchymal mesoderm</th>
          <th>NMP</th>
          <th>Neural crest</th>
          <th>Presomitic mesoderm</th>
          <th>Sclerotome</th>
          <th>Spinal cord</th>
          <th>Splanchnic mesoderm</th>
          <th>Surface ectoderm</th>
          <th>Allantois</th>
          <th>Anterior somitic tissues</th>
          <th>Cardiomyocytes</th>
          <th>Cranial mesoderm</th>
          <th>Definitive endoderm</th>
          <th>Dermomyotome</th>
          <th>Endothelium</th>
          <th>Erythroid</th>
          <th>Forebrain/Midbrain/Hindbrain</th>
          <th>Gut tube</th>
          <th>Haematoendothelial progenitors</th>
          <th>Intermediate mesoderm</th>
          <th>Lateral plate mesoderm</th>
          <th>Low quality</th>
          <th>Mixed mesenchymal mesoderm</th>
          <th>NMP</th>
          <th>Neural crest</th>
          <th>Presomitic mesoderm</th>
          <th>...</th>
          <th>Definitive endoderm</th>
          <th>Dermomyotome</th>
          <th>Endothelium</th>
          <th>Erythroid</th>
          <th>Forebrain/Midbrain/Hindbrain</th>
          <th>Gut tube</th>
          <th>Haematoendothelial progenitors</th>
          <th>Intermediate mesoderm</th>
          <th>Lateral plate mesoderm</th>
          <th>Low quality</th>
          <th>Mixed mesenchymal mesoderm</th>
          <th>NMP</th>
          <th>Neural crest</th>
          <th>Presomitic mesoderm</th>
          <th>Sclerotome</th>
          <th>Spinal cord</th>
          <th>Splanchnic mesoderm</th>
          <th>Surface ectoderm</th>
          <th>Allantois</th>
          <th>Anterior somitic tissues</th>
          <th>Cardiomyocytes</th>
          <th>Cranial mesoderm</th>
          <th>Definitive endoderm</th>
          <th>Dermomyotome</th>
          <th>Endothelium</th>
          <th>Erythroid</th>
          <th>Forebrain/Midbrain/Hindbrain</th>
          <th>Gut tube</th>
          <th>Haematoendothelial progenitors</th>
          <th>Intermediate mesoderm</th>
          <th>Lateral plate mesoderm</th>
          <th>Low quality</th>
          <th>Mixed mesenchymal mesoderm</th>
          <th>NMP</th>
          <th>Neural crest</th>
          <th>Presomitic mesoderm</th>
          <th>Sclerotome</th>
          <th>Spinal cord</th>
          <th>Splanchnic mesoderm</th>
          <th>Surface ectoderm</th>
        </tr>
        <tr>
          <th>source</th>
          <th>target</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>KDR</th>
          <th>PECAM1</th>
          <td>0.999</td>
          <td>0.945</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.001</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.999</td>
          <td>1.000</td>
          <td>0.997</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.352</td>
          <td>0.053</td>
          <td>0.294</td>
          <td>0.063</td>
          <td>0.190</td>
          <td>0.173</td>
          <td>0.0</td>
          <td>0.111</td>
          <td>0.246</td>
          <td>0.156</td>
          <td>0.000</td>
          <td>0.096</td>
          <td>0.178</td>
          <td>0.102</td>
          <td>0.173</td>
          <td>0.256</td>
          <td>0.070</td>
          <td>0.165</td>
          <td>...</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.00</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>0.849</td>
          <td>1.000</td>
          <td>0.999</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>0.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.996</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>1.000</td>
        </tr>
        <tr>
          <th>IGF1</th>
          <th>KDR</th>
          <td>0.995</td>
          <td>0.128</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.999</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.000</td>
          <td>0.993</td>
          <td>0.999</td>
          <td>1.000</td>
          <td>0.999</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.983</td>
          <td>0.989</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.915</td>
          <td>0.016</td>
          <td>0.756</td>
          <td>0.853</td>
          <td>0.980</td>
          <td>0.760</td>
          <td>0.0</td>
          <td>0.951</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.000</td>
          <td>0.490</td>
          <td>0.746</td>
          <td>0.962</td>
          <td>0.925</td>
          <td>0.956</td>
          <td>0.893</td>
          <td>0.342</td>
          <td>...</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.00</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>0.997</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.981</td>
          <td>0.990</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>0.979</td>
          <td>0.026</td>
          <td>0.996</td>
          <td>0.996</td>
          <td>1.000</td>
          <td>0.988</td>
          <td>0.0</td>
          <td>0.999</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>0.000</td>
          <td>0.892</td>
          <td>0.999</td>
          <td>1.0</td>
          <td>0.999</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.689</td>
          <td>0.909</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>0.993</td>
        </tr>
        <tr>
          <th>PDGFA</th>
          <th>KDR</th>
          <td>1.000</td>
          <td>0.313</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.000</td>
          <td>0.994</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.999</td>
          <td>0.990</td>
          <td>0.996</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.998</td>
          <td>0.242</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.000</td>
          <td>0.992</td>
          <td>0.999</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.984</td>
          <td>...</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.00</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.999</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.0</td>
          <td>0.000</td>
          <td>0.0</td>
          <td>0.0</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.0</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.000</td>
          <td>0.0</td>
          <td>0.000</td>
          <td>0.000</td>
        </tr>
        <tr>
          <th>NRP1</th>
          <th>KDR</th>
          <td>0.888</td>
          <td>0.093</td>
          <td>0.818</td>
          <td>0.863</td>
          <td>0.954</td>
          <td>0.838</td>
          <td>0.0</td>
          <td>0.947</td>
          <td>0.997</td>
          <td>0.975</td>
          <td>0.000</td>
          <td>0.716</td>
          <td>0.805</td>
          <td>0.906</td>
          <td>0.906</td>
          <td>0.947</td>
          <td>0.885</td>
          <td>0.630</td>
          <td>0.818</td>
          <td>0.977</td>
          <td>0.956</td>
          <td>0.819</td>
          <td>0.658</td>
          <td>0.017</td>
          <td>0.315</td>
          <td>0.396</td>
          <td>0.698</td>
          <td>0.339</td>
          <td>0.0</td>
          <td>0.577</td>
          <td>0.837</td>
          <td>0.718</td>
          <td>0.000</td>
          <td>0.188</td>
          <td>0.292</td>
          <td>0.472</td>
          <td>0.480</td>
          <td>0.683</td>
          <td>0.408</td>
          <td>0.149</td>
          <td>...</td>
          <td>0.167</td>
          <td>0.002</td>
          <td>0.0</td>
          <td>0.057</td>
          <td>0.12</td>
          <td>0.022</td>
          <td>0.0</td>
          <td>0.000</td>
          <td>0.0</td>
          <td>0.0</td>
          <td>0.009</td>
          <td>0.273</td>
          <td>0.001</td>
          <td>0.001</td>
          <td>0.157</td>
          <td>0.007</td>
          <td>0.015</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>0.125</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>0.000</td>
          <td>0.997</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.996</td>
          <td>0.994</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>1.000</td>
        </tr>
        <tr>
          <th>FGF3</th>
          <th>FGFR3</th>
          <td>0.797</td>
          <td>1.000</td>
          <td>0.998</td>
          <td>1.000</td>
          <td>0.067</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>0.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.000</td>
          <td>0.063</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.999</td>
          <td>0.192</td>
          <td>0.974</td>
          <td>0.965</td>
          <td>0.516</td>
          <td>0.999</td>
          <td>0.891</td>
          <td>1.000</td>
          <td>0.007</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>0.000</td>
          <td>0.980</td>
          <td>0.998</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.000</td>
          <td>0.019</td>
          <td>0.997</td>
          <td>0.999</td>
          <td>...</td>
          <td>0.092</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>0.00</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>0.000</td>
          <td>0.087</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>0.317</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>0.508</td>
          <td>1.000</td>
          <td>0.940</td>
          <td>1.000</td>
          <td>0.002</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>1.000</td>
          <td>0.0</td>
          <td>1.0</td>
          <td>0.999</td>
          <td>1.000</td>
          <td>1.000</td>
          <td>1.0</td>
          <td>0.000</td>
          <td>0.011</td>
          <td>0.999</td>
          <td>1.000</td>
          <td>0.974</td>
          <td>0.0</td>
          <td>0.559</td>
          <td>0.437</td>
        </tr>
      </tbody>
    </table>
    <p>5 rows × 484 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 59-60

Any interaction metadata downloaded from :mod:`omnipath`, such as the interaction type, can be accessed as:

.. GENERATED FROM PYTHON SOURCE LINES 60-62

.. code-block:: default

    res["metadata"].head()






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th></th>
          <th>aspect_intercell_source</th>
          <th>aspect_intercell_target</th>
          <th>category_intercell_source</th>
          <th>category_intercell_target</th>
          <th>category_source_intercell_source</th>
          <th>category_source_intercell_target</th>
          <th>consensus_direction</th>
          <th>consensus_inhibition</th>
          <th>consensus_score_intercell_source</th>
          <th>consensus_score_intercell_target</th>
          <th>consensus_stimulation</th>
          <th>curation_effort</th>
          <th>database_intercell_source</th>
          <th>database_intercell_target</th>
          <th>entity_type_intercell_source</th>
          <th>entity_type_intercell_target</th>
          <th>is_inhibition</th>
          <th>is_stimulation</th>
          <th>n_primary_sources</th>
          <th>n_references</th>
          <th>n_sources</th>
          <th>parent_intercell_source</th>
          <th>parent_intercell_target</th>
          <th>plasma_membrane_peripheral_intercell_source</th>
          <th>plasma_membrane_peripheral_intercell_target</th>
          <th>plasma_membrane_transmembrane_intercell_source</th>
          <th>plasma_membrane_transmembrane_intercell_target</th>
          <th>receiver_intercell_source</th>
          <th>receiver_intercell_target</th>
          <th>references</th>
          <th>references_stripped</th>
          <th>scope_intercell_source</th>
          <th>scope_intercell_target</th>
          <th>secreted_intercell_source</th>
          <th>secreted_intercell_target</th>
          <th>sources</th>
          <th>transmitter_intercell_source</th>
          <th>transmitter_intercell_target</th>
          <th>type</th>
          <th>uniprot_intercell_source</th>
          <th>uniprot_intercell_target</th>
        </tr>
        <tr>
          <th>source</th>
          <th>target</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>KDR</th>
          <th>PECAM1</th>
          <td>functional</td>
          <td>functional</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>resource_specific</td>
          <td>resource_specific</td>
          <td>True</td>
          <td>False</td>
          <td>1</td>
          <td>10</td>
          <td>True</td>
          <td>0</td>
          <td>NaN</td>
          <td>scConnect;CellCellInteractions;HGNC;CellPhoneD...</td>
          <td>protein</td>
          <td>protein</td>
          <td>False</td>
          <td>True</td>
          <td>1</td>
          <td>None</td>
          <td>1</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>NaN</td>
          <td>None</td>
          <td>generic</td>
          <td>generic</td>
          <td>True</td>
          <td>False</td>
          <td>Wang</td>
          <td>True</td>
          <td>False</td>
          <td>post_translational</td>
          <td>P35968</td>
          <td>P16284</td>
        </tr>
        <tr>
          <th>IGF1</th>
          <th>KDR</th>
          <td>functional</td>
          <td>functional</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>resource_specific</td>
          <td>resource_specific</td>
          <td>True</td>
          <td>False</td>
          <td>21</td>
          <td>23</td>
          <td>True</td>
          <td>0</td>
          <td>talklr;iTALK;ICELLNET;CellTalkDB;Ramilowski201...</td>
          <td>talklr;Cellinker;scConnect;connectomeDB2020;iT...</td>
          <td>protein</td>
          <td>protein</td>
          <td>False</td>
          <td>True</td>
          <td>1</td>
          <td>None</td>
          <td>1</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>NaN</td>
          <td>None</td>
          <td>generic</td>
          <td>generic</td>
          <td>True</td>
          <td>True</td>
          <td>Wang</td>
          <td>True</td>
          <td>False</td>
          <td>post_translational</td>
          <td>P05019</td>
          <td>P35968</td>
        </tr>
        <tr>
          <th>PDGFA</th>
          <th>KDR</th>
          <td>functional</td>
          <td>functional</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>resource_specific</td>
          <td>resource_specific</td>
          <td>True</td>
          <td>False</td>
          <td>18</td>
          <td>23</td>
          <td>True</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>protein</td>
          <td>protein</td>
          <td>False</td>
          <td>True</td>
          <td>1</td>
          <td>None</td>
          <td>1</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>NaN</td>
          <td>None</td>
          <td>generic</td>
          <td>generic</td>
          <td>True</td>
          <td>True</td>
          <td>Wang</td>
          <td>True</td>
          <td>False</td>
          <td>post_translational</td>
          <td>P04085</td>
          <td>P35968</td>
        </tr>
        <tr>
          <th>NRP1</th>
          <th>KDR</th>
          <td>functional</td>
          <td>functional</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>resource_specific</td>
          <td>resource_specific</td>
          <td>True</td>
          <td>False</td>
          <td>2</td>
          <td>23</td>
          <td>True</td>
          <td>8</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>protein</td>
          <td>protein</td>
          <td>False</td>
          <td>True</td>
          <td>4</td>
          <td>7</td>
          <td>5</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>BioGRID:11948691;BioGRID:19857463;BioGRID:2603...</td>
          <td>11333271;11948691;16763549;17145710;17222790;1...</td>
          <td>generic</td>
          <td>generic</td>
          <td>True</td>
          <td>True</td>
          <td>BioGRID;CellChatDB-cofactors;HPRD;SPIKE_LC;Wang</td>
          <td>True</td>
          <td>False</td>
          <td>post_translational</td>
          <td>O14786</td>
          <td>P35968</td>
        </tr>
        <tr>
          <th>FGF3</th>
          <th>FGFR3</th>
          <td>functional</td>
          <td>functional</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>resource_specific</td>
          <td>resource_specific</td>
          <td>False</td>
          <td>False</td>
          <td>18</td>
          <td>20</td>
          <td>False</td>
          <td>6</td>
          <td>CellTalkDB;LRdb;OmniPath</td>
          <td>NaN</td>
          <td>protein</td>
          <td>protein</td>
          <td>False</td>
          <td>False</td>
          <td>12</td>
          <td>1</td>
          <td>17</td>
          <td>ligand</td>
          <td>receptor</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>Baccin2019:8663044;CellTalkDB:8663044;Cellinke...</td>
          <td>8663044</td>
          <td>generic</td>
          <td>generic</td>
          <td>True</td>
          <td>True</td>
          <td>Baccin2019;CellCall;CellTalkDB;Cellinker;EMBRA...</td>
          <td>True</td>
          <td>False</td>
          <td>post_translational</td>
          <td>P11487</td>
          <td>P22607</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 63-71

In order to plot the results, we can run :func:`squidpy.pl.ligrec`. Some useful parameters are:

  - ``{source,target}_groups`` - only plot specific source/target clusters.
  - ``dendrogram`` - whether to hierarchically cluster the rows, columns or both.
  - ``mean_range`` - plot only interactions whose means are in this range.
  - ``pval_threshold`` - plot only interactions whose p-values are below this threshold.

In the plot below, to highlight significance, we've marked all p-values <= 0.005 with tori.

.. GENERATED FROM PYTHON SOURCE LINES 71-72

.. code-block:: default

    sq.pl.ligrec(res, source_groups="Erythroid", alpha=0.005)



.. image-sg:: /auto_examples/graph/images/sphx_glr_compute_ligrec_001.png
   :alt: Receptor-ligand test, $-\log_{10} ~ P$, significant $p=0.005$, $log_2(\frac{molecule_1 + molecule_2}{2} + 1)$
   :srcset: /auto_examples/graph/images/sphx_glr_compute_ligrec_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/squidpy_notebooks/squidpy_notebooks/.tox/docs/lib/python3.9/site-packages/scanpy/plotting/_dotplot.py:749: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap', 'norm' will be ignored
      dot_ax.scatter(x, y, **kwds)





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  38.630 seconds)

**Estimated memory usage:**  156 MB


.. _sphx_glr_download_auto_examples_graph_compute_ligrec.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: compute_ligrec.py <compute_ligrec.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: compute_ligrec.ipynb <compute_ligrec.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
